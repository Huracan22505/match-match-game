(()=>{"use strict";var e={596:(e,t,n)=>{n.r(t)},8:(e,t,n)=>{n.r(t)},76:(e,t,n)=>{n.r(t)},147:(e,t,n)=>{n.r(t)},712:(e,t,n)=>{n.r(t)},528:(e,t,n)=>{n.r(t)},346:(e,t,n)=>{n.r(t)},3:(e,t,n)=>{n.r(t)},148:(e,t,n)=>{n.r(t)},580:(e,t,n)=>{n.r(t)},373:(e,t,n)=>{n.r(t)},752:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(s,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function r(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const s=n(229);t.App=class{constructor(e){this.rootElement=e,this.game=new s.Game,this.rootElement.appendChild(this.game.element)}start(){return a(this,void 0,void 0,(function*(){const e=yield fetch("./images.json"),t=yield e.json(),n=localStorage.getItem("gameCategory"),a=localStorage.getItem("gameDifficulty"),s=t.filter((({category:e})=>e===n))[0],{images:i}=s;"4x4"===a&&this.game.newGame(i.slice(0,8)),"6x6"===a&&this.game.newGame(i)}))}}},54:function(e,t,n){var a,s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.navWrapper=t.aboutRender=void 0;const i=s(n(334)),o=n(610);n(596);const r=document.createElement("div");t.navWrapper=r,null===(a=i.default.appElement)||void 0===a||a.append(r),t.aboutRender=function(){r.innerHTML='<section class="about-section">\n      <div class="container">\n        <h2 class="title">How to play?</h2>\n        <div class="about-container">\n          <ul class="step-list">\n            <li class="item list">\n              <div class="numbering">1</div>\n              <p class="text">Stay safe.</p>\n            </li>\n            <li class="item list">\n              <div class="numbering">2</div>\n              <p class="text">Configure your game settings.</p>\n            </li>\n            <li class="item list">\n              <div class="numbering">3</div>\n              <p class="text">Click "START GAME" button.</p>\n            </li>\n            <li class="item list">\n              <div class="numbering">4</div>\n              <p class="text">\n                You have 10 seconds to memorize the position of the cards.\n              </p>\n            </li>\n            <li class="item list">\n              <div class="numbering">5</div>\n              <p class="text">\n                Find all matches.\n              </p>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </section>\n',window.location.hash="about";const e=document.querySelector(".cards-field");e&&(e.innerHTML="",o.removeTimer())}},251:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backdropMarkup=void 0,n(8),t.backdropMarkup="<div class='cover hidden' id='cover'></div>"},583:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponent=void 0,t.BaseComponent=class{constructor(e="div",t=[]){this.element=document.createElement(e),t.length>0&&this.element.classList.add(...t)}}},343:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Card=void 0;const a=n(583);n(76);class s extends a.BaseComponent{constructor(e){super("div",["card-container"]),this.image=e,this.isFlipped=!1,this.element.innerHTML=`\n    <div class="card">\n      <div class="card__front" style="background-image: url('${e}')"></div>\n      <div class="card__back"></div>\n    </div>`}flipToBack(){return this.isFlipped=!0,this.flip(!0)}flipToFront(){return this.isFlipped=!1,this.flip()}flip(e=!1){return new Promise((t=>{this.element.classList.toggle("flipped",e),this.element.addEventListener("transitionend",(()=>t()),{once:!0})}))}}t.Card=s},860:function(e,t,n){var a,s,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.addWinModalMarkup=void 0;const o=i(n(334)),r=n(251),l=n(276);n(147),null===(a=o.default.appElement)||void 0===a||a.insertAdjacentHTML("beforeend",r.backdropMarkup);const c=document.createElement("div");null===(s=o.default.appElement)||void 0===s||s.append(c),t.addWinModalMarkup=(e,t)=>{c.innerHTML=((e,t)=>`\n<section class="win-game-modal">\n      <div id="modal" class="modal">\n        <div class="modal-content">\n          <span class="close">&times;</span>\n          <h2>Congratulations!</h2>\n          <p>You successfully found all matches for ${e} secs</p>\n          <p>Your score - ${t}</p>\n          <img\n            class="modal-img"\n            src="https://image.freepik.com/free-vector/you-win-sign-in-pop-art-style_175838-498.jpg"\n            alt="win picture"\n          />\n          <button type="button" class="button accept-btn">Ok</button>\n        </div>\n      </div>\n    </section>\n`)(e.toString(),t),(()=>{const e=document.getElementById("modal"),t=document.querySelector(".close"),n=document.getElementById("cover"),a=document.querySelector(".accept-btn");if(!n)throw Error("coverElem element not found");if(!e)throw Error("modal element not found");e.style.display="block",document.body.classList.add("notScrollable");const s=()=>{l.addRegFormMarkup(),n.classList.remove("hidden"),e.style.display="none"};null==t||t.addEventListener("click",(()=>{s()})),e.addEventListener("click",(t=>{t.target===e&&s()})),null==a||a.addEventListener("click",(()=>{s()}))})()}},249:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CardsField=void 0;const a=n(583);n(712);class s extends a.BaseComponent{constructor(){super("div",["cards-field"]),this.cards=[]}clear(){this.cards=[],this.element.innerHTML=""}addCards(e){this.cards=e,this.cards.forEach((e=>this.element.appendChild(e.element))),setTimeout((()=>{this.cards.forEach((e=>e.flipToBack()))}),1e4)}}t.CardsField=s},229:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(s,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function r(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}l((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const s=n(680),i=n(583),o=n(343),r=n(249),l=n(860),c=n(610);let d,u,m,p=0;m="6x6"===localStorage.getItem("gameDifficulty")?16:8;class v extends i.BaseComponent{constructor(){super(),this.isAnimation=!1,this.cardsField=new r.CardsField,this.element.appendChild(this.cardsField.element)}newGame(e){this.cardsField.clear();const t=e.concat(e).map((e=>new o.Card(e))).sort((()=>Math.random()-.5));t.forEach((e=>{e.element.addEventListener("click",(()=>this.cardHandler(e)))})),this.cardsField.addCards(t)}cardHandler(e){return a(this,void 0,void 0,(function*(){if(!this.isAnimation&&e.isFlipped){if(this.isAnimation=!0,yield e.flipToFront(),!this.activeCard)return this.activeCard=e,void(this.isAnimation=!1);if(this.activeCard.image!==e.image?(this.activeCard.element.classList.add("mistake-true"),e.element.classList.add("mistake-true"),yield s.delay(700),this.activeCard.element.classList.remove("mistake-true"),e.element.classList.remove("mistake-true"),yield Promise.all([this.activeCard.flipToBack(),e.flipToBack()]),p+=1):(this.activeCard.element.classList.add("mistake-false"),e.element.classList.add("mistake-false")),this.activeCard=void 0,this.isAnimation=!1,this.cardsField.cards.every((e=>!1===e.isFlipped))){const e=document.querySelector(".timer");if(!(null==e?void 0:e.textContent))throw Error("Timer element not found");d=Number(e.textContent.replace("secs","")),u=100*(m-p)-10*d,l.addWinModalMarkup(d,u>0?u:0),c.removeTimer(),p=0,u<0?localStorage.setItem("score","0"):localStorage.setItem("score",u.toString())}}}))}}t.Game=v},977:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.headerRender=void 0;const s=a(n(334));n(528),t.headerRender=()=>{var e;null===(e=s.default.appElement)||void 0===e||e.insertAdjacentHTML("afterbegin",'<header class="header">\n      <h1 class="hidden">Match Match Game</h1>\n      <div class="wrapper">\n         <a href="#about" class="logo" >\n         <p class="logo-up">Match</p>\n          <p class="logo-down">Match</p>\n          </a>\n        <ul class="info">\n          <li class="button" id="about">About</li>\n          <li class="button" id="score">Score</li>\n          <li class="button" id="settings">Settings</li>\n        </ul>\n      </div>\n    </header>\n    <button class="button start-btn">start game</button>\n')}},276:function(e,t,n){var a,s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.addRegFormMarkup=void 0;const i=s(n(334)),o=n(570);n(346);const r=document.createElement("div");null===(a=i.default.appElement)||void 0===a||a.append(r);const l="./form-checkbox.png",c=`<div class="reg-modal hidden" id="reg-form">\n      <p class="modal__title">Registr New Player</p>\n      <form action="submit" class="modal__form">\n        <div class="form__wrapper">\n          <div class="modal__form__input">\n            <label>First name</label>\n            <input\n            class="name"\n            id="name"\n            type="name"\n            required\n            title="- Имя не может быть пустым.\n                 - Имя не может состоять из цифр.\n                 - Имя не может содержать служебные символы"\n          pattern="[a-zA-Zа-яА-Я]+"\n          maxlength="30"/>\n            <div class="checkbox name-ch">\n              <img\n                src="${l}"\n                alt=""\n                width="20px"\n                height="20px"\n              />\n            </div>\n          </div>\n          <div class="modal__form__input">\n            <label>Last name</label>\n            <input\n            class="surname"\n            id="lastName"\n            type="text"\n            required\n            title="- Имя не может быть пустым.\n                 - Имя не может состоять из цифр.\n                 - Имя не может содержать служебные символы"\n            pattern="[a-zA-Zа-яА-Я]+"\n          maxlength="30" />\n            <div class="checkbox surname-ch">\n              <img\n                src="${l}"\n                alt=""\n                width="20px"\n                height="20px"\n              />\n            </div>\n          </div>\n          <div class="modal__form__input">\n            <label>E-mail</label>\n            <input\n            class="email"\n            id="email"\n            type="email"\n            required\n            pattern="[a-zA-Z0-9]+@[a-zA-Z0-9]{2,10}[.]+[a-zA-Z0-9]+" />\n            <div class="checkbox email-ch">\n              <img\n                src="${l}"\n                alt=""\n                width="20px"\n                height="20px"\n              />\n            </div>\n          </div>\n        </div>\n        <div class="avatar-container">\n              <img class="img" id="uploadedImage" src="./form-avatar.png">\n              <input class="input" id="avatarUpload" name="upload" type="file">\n            </div>\n        <div class="modal__form__buttons">\n          <button\n            class="form__modal__submitbtn form__modal__btn invalid"\n            id="send"\n            type="submit"\n          >\n            Add user</button\n          ><button\n            class="form__modal__cancelbtn form__modal__btn"\n            id="cancel"\n            type="button"\n          >\n            Cancel\n          </button>\n        </div>\n      </form>\n`;t.addRegFormMarkup=()=>{r.innerHTML=c,(()=>{const e=document.getElementById("cover"),t=document.getElementById("reg-form"),n=document.getElementById("send"),a=document.getElementById("cancel"),s=document.getElementById("name"),i=document.getElementById("lastName"),r=document.getElementById("email");t.classList.remove("hidden");const l=()=>{s.validity.valid&&r.validity.valid?n.classList.remove("invalid"):n.classList.add("invalid")};e.addEventListener("click",(()=>{document.body.classList.remove("notScrollable"),e.classList.add("hidden"),t.classList.add("hidden")})),a.addEventListener("click",(()=>{document.body.classList.remove("notScrollable"),e.classList.add("hidden"),t.classList.add("hidden"),localStorage.removeItem("avatar")})),n.addEventListener("click",(a=>{n.classList.contains("invalid")||(a.preventDefault(),o.postData(),document.body.classList.remove("notScrollable"),e.classList.add("hidden"),t.classList.add("hidden"),setTimeout((()=>{window.location.hash="score"}),150))})),s.addEventListener("input",l),i.addEventListener("input",l),r.addEventListener("input",l);const c=document.getElementById("avatarUpload"),d=document.getElementById("uploadedImage");c.addEventListener("change",(()=>{const e=URL.createObjectURL(c.files[0]),t=document.createElement("canvas"),n=new Image;n.setAttribute("crossOrigin","anonymous"),n.src=e,n.onload=()=>{t.width=n.naturalWidth,t.height=n.naturalHeight,t.getContext("2d").drawImage(n,0,0,t.width,t.height);const e=document.createElement("a");e.href=t.toDataURL("image/png"),localStorage.setItem("avatar",e.href),d.src=e.href}}))})()}},295:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.scoreRender=void 0;const a=n(54),s=n(610),i=n(570);n(3),t.scoreRender=function(){a.navWrapper.innerHTML="",a.navWrapper.insertAdjacentHTML("beforeend",function(e){const t=e.sort(((e,t)=>Number(t.score)-Number(e.score)));return`    <section class="score-section">\n      <div class="container">\n        <h2 class="title">Best players</h2>\n        <div class="score-container">\n          <ul class="score-list">${e.length<1?'<p class="name">There are no records yet. You need to play!</p>':t.map((({name:e,lastName:t,email:n,score:a,avatar:s})=>`<li class="item">\n              <div class="name-container" >\n              <img class="img" src="${s||"./form-avatar.png"}" alt="" width="40px" height="40px" >\n              <div class="email-container" >\n              <p class="name">\n              ${e} ${t}\n              </p>\n              <span class="email" >${n}</span>\n              </div>\n              </div>\n              <p class="rating">Score: <span class="count">${a}</span></p>\n            </li>`)).filter(((e,t,n)=>n.indexOf(e)===t)).slice(0,10).join("")}\n          </ul>\n        </div>\n      </div>\n    </section>\n`}(i.usersData)),window.location.hash="score";const e=document.querySelector(".cards-field");e&&(e.innerHTML="",s.removeTimer())}},831:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.settingsRender=void 0;const a=n(54),s=n(610);n(148),t.settingsRender=function(){a.navWrapper.innerHTML="",a.navWrapper.insertAdjacentHTML("beforeend",'<section class="settings-section">\n      <div class="container">\n      <h2 class="title">Game cards</h2>\n        <select class="select-css" id="game-categories">\n          <option>select game cards type</option>\n          <option>Animals</option>\n          <option>Toys</option>\n          <option>Coding</option>\n        </select>\n\n        <h2 class="title">Difficulty</h2>\n        <select class="select-css" id="game-difficult">\n          <option>select game type</option>\n          <option>4x4</option>\n          <option>6x6</option>\n        </select>\n      </div>\n    </section>\n'),window.location.hash="settings",(()=>{const e=document.querySelector("#game-categories"),t=document.querySelector("#game-difficult");if(!e)throw Error("Select element not found");if(!t)throw Error("Select element not found");e.addEventListener("change",(e=>{const{value:t}=e.target;localStorage.setItem("gameCategory",t)})),t.addEventListener("change",(e=>{const{value:t}=e.target;localStorage.setItem("gameDifficulty",t)}))})();const e=document.querySelector(".cards-field");e&&(e.innerHTML="",s.removeTimer())}},610:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.removeTimer=t.gameTimer=void 0;const s=a(n(334));let i;n(580);let o=-10;const r=document.createElement("div");t.gameTimer=()=>{i=setInterval((()=>{o+=1,1===o&&s.default.appElement.appendChild(r),r.innerHTML=`<span class='timer'>${o} secs</span>`}),1e3)},t.removeTimer=()=>{clearInterval(i),o=-10,r.remove()}},570:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.usersData=t.postData=t.createDataBase=void 0;const n=[];let a;t.usersData=n;const s=()=>new Promise((e=>{let t=null;t=a.transaction("users","readonly");const s=t.objectStore("users").index("score").openCursor(null,"prev");s.onsuccess=()=>{const t=s.result;t&&e(n.push(null==t?void 0:t.value)),null==t||t.continue()},t.oncomplete=()=>{e(n)}}));t.postData=()=>new Promise((()=>{(e=>{const t=e;a.transaction(["users"],"readwrite").objectStore("users").put(t),s()})((()=>{const e=document.getElementById("name"),t=document.getElementById("lastName"),n=document.getElementById("email"),a=localStorage.getItem("score"),s=localStorage.getItem("avatar"),i={name:e.value,lastName:t.value,email:n.value,score:a,avatar:s};return localStorage.removeItem("avatar"),i})())})),t.createDataBase=(e,t)=>{const n=window.indexedDB.open(e,t);n.onupgradeneeded=()=>{const e=n.result,t=e.createObjectStore("users",{keyPath:"email",autoIncrement:!0});t.createIndex("email","email",{unique:!0}),t.createIndex("score","score",{unique:!1}),a=e},n.onsuccess=()=>{a=n.result,s()},n.onerror=()=>{throw Error(`error opening database ${n.result}`)}}},80:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.routing=void 0;const s=a(n(334)),i=n(752),o=n(54),r=n(295),l=n(831),c=n(610);t.routing=()=>{const e=document.getElementById("score"),t=document.getElementById("about"),n=document.getElementById("settings"),a=document.querySelector(".start-btn");t.addEventListener("click",o.aboutRender),e.addEventListener("click",r.scoreRender),n.addEventListener("click",l.settingsRender);const d=()=>{window.location.hash="game","RESTART GAME"===a.innerHTML&&(document.querySelector(".cards-field").remove(),c.removeTimer()),c.gameTimer(),o.navWrapper.innerHTML="",new i.App(s.default.appElement).start(),a.innerHTML="RESTART GAME";const e=document.querySelector(".cards-field");"6x6"===localStorage.getItem("gameDifficulty")?e.setAttribute("style","width:1440px;"):e.setAttribute("style","width:640px;")},u=()=>{(a=>{switch(window.location.hash?window.location.hash.slice(1):""){case"score":e.classList.add("current"),t.classList.remove("current"),n.classList.remove("current"),r.scoreRender();break;case"settings":n.classList.add("current"),t.classList.remove("current"),e.classList.remove("current"),l.settingsRender();break;case"game":t.classList.remove("current"),e.classList.remove("current"),n.classList.remove("current"),d();break;default:t.classList.add("current"),e.classList.remove("current"),n.classList.remove("current"),o.aboutRender()}})()};window.addEventListener("hashchange",u),a.addEventListener("click",d),u()}},680:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise((t=>{setTimeout(t,e)}))}},334:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default={appElement:document.getElementById("app")}}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,n),i.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=n(977),t=n(570),a=n(80);n(373),localStorage.setItem("gameCategory","Animals"),localStorage.setItem("gameDifficulty","4x4"),e.headerRender(),a.routing(),t.createDataBase("Huracan22505")})()})();